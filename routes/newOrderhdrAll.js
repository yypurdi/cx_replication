/*
 * script route generated by KOMA
 * @author : Yan Yan Purdiansah
 */    
var express = require('express');
var router = express.Router();
var dateFormat = require('dateformat');    
var database = require('./dao');
var dao = new database.Dao();    
var sessionChecker = require('./security');
var appresource = {
    Title:'OrderhdrAllNew',
    Heading:'OrderhdrAll',
    Ohxact:{label :'Ohxact'},
    Ohstatus:{label :'Ohstatus'},
    Ohstatusflg:{label :'Ohstatusflg'},
    Ohentdate:{label :'Ohentdate'},
    Ohrefnum:{label :'Ohrefnum'},
    Ohtshdate:{label :'Ohtshdate'},
    Ohsls:{label :'Ohsls'},
    CustomerId:{label :'CustomerId'},
    Ohcseq:{label :'Ohcseq'},
    Ohsname:{label :'Ohsname'},
    Ohsaddr1:{label :'Ohsaddr1'},
    Ohsaddr2:{label :'Ohsaddr2'},
    Ohsaddr3:{label :'Ohsaddr3'},
    Ohscity:{label :'Ohscity'},
    Ohsst:{label :'Ohsst'},
    Ohszip:{label :'Ohszip'},
    Ohscountry:{label :'Ohscountry'},
    Ohscrc:{label :'Ohscrc'},
    Ohattn:{label :'Ohattn'},
    Ohtrucker:{label :'Ohtrucker'},
    Ohponum:{label :'Ohponum'},
    Ohrelease:{label :'Ohrelease'},
    Ohpsno:{label :'Ohpsno'},
    Ohfrtterms:{label :'Ohfrtterms'},
    Ohordtyp:{label :'Ohordtyp'},
    Ohcandate:{label :'Ohcandate'},
    Ohassocxact:{label :'Ohassocxact'},
    Ohprt1:{label :'Ohprt1'},
    Ohprt2:{label :'Ohprt2'},
    Ohprt3:{label :'Ohprt3'},
    Ohuserid:{label :'Ohuserid'},
    Ohrefdate:{label :'Ohrefdate'},
    Ohshpdate:{label :'Ohshpdate'},
    Ohduedate:{label :'Ohduedate'},
    Ohipp:{label :'Ohipp'},
    Ohilpp:{label :'Ohilpp'},
    Ohpostgl:{label :'Ohpostgl'},
    Ohpostar:{label :'Ohpostar'},
    OharcustomerId:{label :'OharcustomerId'},
    Ohglar:{label :'Ohglar'},
    Ohdisdate:{label :'Ohdisdate'},
    DdebitFlag:{label :'DdebitFlag'},
    Oharflg:{label :'Oharflg'},
    Ohinvtype:{label :'Ohinvtype'},
    Ohfulfildate:{label :'Ohfulfildate'},
    OhpaymentId:{label :'OhpaymentId'},
    Ohpostfibu:{label :'Ohpostfibu'},
    Ohreason:{label :'Ohreason'},
    OhrsId:{label :'OhrsId'},
    Ohddhflag:{label :'Ohddhflag'},
    Ohddhdate:{label :'Ohddhdate'},
    Ohfct:{label :'Ohfct'},
    Ohlct:{label :'Ohlct'},
    Ohmod:{label :'Ohmod'},
    Ohxrate:{label :'Ohxrate'},
    Oheccode:{label :'Oheccode'},
    Ohecname:{label :'Ohecname'},
    Ohglexact:{label :'Ohglexact'},
    Ohdunstep:{label :'Ohdunstep'},
    Ohflfct:{label :'Ohflfct'},
    Ohfllct:{label :'Ohfllct'},
    CoId:{label :'CoId'},
    Complaint:{label :'Complaint'},
    ComplaintDate:{label :'ComplaintDate'},
    RtxStatus:{label :'RtxStatus'},
    Ohbillseqno:{label :'Ohbillseqno'},
    Ohcancelflag:{label :'Ohcancelflag'},
    ConvdateExchange:{label :'ConvdateExchange'},
    OhglexactTax:{label :'OhglexactTax'},
    GlacodeDiff:{label :'GlacodeDiff'},
    JobcostIdDiff:{label :'JobcostIdDiff'},
    TaxRoundingFlag:{label :'TaxRoundingFlag'},
    GlCurrency:{label :'GlCurrency'},
    DocumentCurrency:{label :'DocumentCurrency'},
    DocumentConvratetypeId:{label :'DocumentConvratetypeId'},
    SecondaryCurrency:{label :'SecondaryCurrency'},
    SecondaryConvratetypeId:{label :'SecondaryConvratetypeId'},
    OhinvamtGl:{label :'OhinvamtGl'},
    OhopnamtGl:{label :'OhopnamtGl'},
    OhdisamtGl:{label :'OhdisamtGl'},
    OhdistakamtGl:{label :'OhdistakamtGl'},
    OhtaxamtGl:{label :'OhtaxamtGl'},
    TaxamtDiffGl:{label :'TaxamtDiffGl'},
    OhinvamtDoc:{label :'OhinvamtDoc'},
    OhopnamtDoc:{label :'OhopnamtDoc'},
    OhdisamtDoc:{label :'OhdisamtDoc'},
    OhdistakamtDoc:{label :'OhdistakamtDoc'},
    OhtaxamtDoc:{label :'OhtaxamtDoc'},
    GlConvratetypeId:{label :'GlConvratetypeId'},
    FeeBalance:{label :'FeeBalance'},
    FeeBalanceGross:{label :'FeeBalanceGross'},
    Currency:{label :'Currency'},
    Ohcostcent:{label :'Ohcostcent'},
    RecVersion:{label :'RecVersion'},
    OhinvamtSecdoc:{label :'OhinvamtSecdoc'},
    TaxamtDiffSecdoc:{label :'TaxamtDiffSecdoc'},
    Paymentfailed:{label :'Paymentfailed'},
    BillingAccountId:{label :'BillingAccountId'},
    BalancePageEventDate:{label :'BalancePageEventDate'},
    PrepaidBalanceChangeDoc:{label :'PrepaidBalanceChangeDoc'},
    PrepaidBalanceChangeGl:{label :'PrepaidBalanceChangeGl'},
    PrepaidGlacode:{label :'PrepaidGlacode'},
    PrepaidTaxamtDiffGl:{label :'PrepaidTaxamtDiffGl'},
    PrepaidTaxDiffGlacode:{label :'PrepaidTaxDiffGlacode'},
    PaymentConditionId:{label :'PaymentConditionId'},
    Ohdocstatus:{label :'Ohdocstatus'},
    Ohextrefdate:{label :'Ohextrefdate'},
    Ohextrefnum:{label :'Ohextrefnum'},
    Ohcmident:{label :'Ohcmident'},
    Ohremark:{label :'Ohremark'},
    OhdiscbaseDoc:{label :'OhdiscbaseDoc'},
    Ohproppaycurr:{label :'Ohproppaycurr'},
    Ohproppaydate:{label :'Ohproppaydate'},
    OhprocessType:{label :'OhprocessType'},
    OhprocessDate:{label :'OhprocessDate'},
    BusinessUnitId:{label :'BusinessUnitId'},
    ProposedPaymentMethod:{label :'ProposedPaymentMethod'},
    ReasonId:{label :'ReasonId'},
    IncomingDocPricingType:{label :'IncomingDocPricingType'},
    IncomingDocTaxPerItem:{label :'IncomingDocTaxPerItem'},
    PaymentProposalId:{label :'PaymentProposalId'},
    }

router.get('/', sessionChecker, function(req, res, next) {
    parameter = {
        session: req.session,
        cookies: req.cookies,
        resource: appresource,
        dateFormat: dateFormat,
        statusCode:100,
        statusMessage:'',        
        record:{ohxact:'',
        ohstatus:'',
        ohstatusflg:'',
        ohentdate:'',
        ohrefnum:'',
        ohtshdate:'',
        ohsls:'',
        customerId:'',
        ohcseq:'',
        ohsname:'',
        ohsaddr1:'',
        ohsaddr2:'',
        ohsaddr3:'',
        ohscity:'',
        ohsst:'',
        ohszip:'',
        ohscountry:'',
        ohscrc:'',
        ohattn:'',
        ohtrucker:'',
        ohponum:'',
        ohrelease:'',
        ohpsno:'',
        ohfrtterms:'',
        ohordtyp:'',
        ohcandate:'',
        ohassocxact:'',
        ohprt1:'',
        ohprt2:'',
        ohprt3:'',
        ohuserid:'',
        ohrefdate:'',
        ohshpdate:'',
        ohduedate:'',
        ohipp:'',
        ohilpp:'',
        ohpostgl:'',
        ohpostar:'',
        oharcustomerId:'',
        ohglar:'',
        ohdisdate:'',
        ddebitFlag:'',
        oharflg:'',
        ohinvtype:'',
        ohfulfildate:'',
        ohpaymentId:'',
        ohpostfibu:'',
        ohreason:'',
        ohrsId:'',
        ohddhflag:'',
        ohddhdate:'',
        ohfct:'',
        ohlct:'',
        ohmod:'',
        ohxrate:'',
        oheccode:'',
        ohecname:'',
        ohglexact:'',
        ohdunstep:'',
        ohflfct:'',
        ohfllct:'',
        coId:'',
        complaint:'',
        complaintDate:'',
        rtxStatus:'',
        ohbillseqno:'',
        ohcancelflag:'',
        convdateExchange:'',
        ohglexactTax:'',
        glacodeDiff:'',
        jobcostIdDiff:'',
        taxRoundingFlag:'',
        glCurrency:'',
        documentCurrency:'',
        documentConvratetypeId:'',
        secondaryCurrency:'',
        secondaryConvratetypeId:'',
        ohinvamtGl:'',
        ohopnamtGl:'',
        ohdisamtGl:'',
        ohdistakamtGl:'',
        ohtaxamtGl:'',
        taxamtDiffGl:'',
        ohinvamtDoc:'',
        ohopnamtDoc:'',
        ohdisamtDoc:'',
        ohdistakamtDoc:'',
        ohtaxamtDoc:'',
        glConvratetypeId:'',
        feeBalance:'',
        feeBalanceGross:'',
        currency:'',
        ohcostcent:'',
        recVersion:'',
        ohinvamtSecdoc:'',
        taxamtDiffSecdoc:'',
        paymentfailed:'',
        billingAccountId:'',
        balancePageEventDate:'',
        prepaidBalanceChangeDoc:'',
        prepaidBalanceChangeGl:'',
        prepaidGlacode:'',
        prepaidTaxamtDiffGl:'',
        prepaidTaxDiffGlacode:'',
        paymentConditionId:'',
        ohdocstatus:'',
        ohextrefdate:'',
        ohextrefnum:'',
        ohcmident:'',
        ohremark:'',
        ohdiscbaseDoc:'',
        ohproppaycurr:'',
        ohproppaydate:'',
        ohprocessType:'',
        ohprocessDate:'',
        businessUnitId:'',
        proposedPaymentMethod:'',
        reasonId:'',
        incomingDocPricingType:'',
        incomingDocTaxPerItem:'',
        paymentProposalId:'',
        }
    }
    res.render('OrderhdrAllNewPage',parameter);
    console.log(parameter);
});
router.post('/', sessionChecker, function(req, res, next) {
    var jsonObj = req.body;
    parameter = {
        session: req.session,
        cookies: req.cookies,
        resource: appresource,
        dateFormat: dateFormat,
    }    
    dao.newOrderhdrAll(jsonObj,function(err,rows) {
        if(err==null){
            parameter.statusCode = 200;
            parameter.statusMessage = 'Successfully created';
        }else{
            parameter.statusCode = err.code;
            parameter.statusMessage = err.message;
        }
        parameter.record = jsonObj;
        res.render('OrderhdrAllNewPage',parameter);
        console.log(parameter);        
    });
});

module.exports = router;
