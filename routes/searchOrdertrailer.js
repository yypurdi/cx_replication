/*
 * script route generated by KOMA
 * @author : Yan Yan Purdiansah
 */    
var express = require('express');
var router = express.Router();
var dateFormat = require('dateformat');    
var database = require('./dao');
var dao = new database.Dao();    
var sessionChecker = require('./security');
var appresource = {
    Title:'OrdertrailerSearch',
    Heading:'Ordertrailer',
    Otxact:{label :'Otxact'},
    Otseq:{label :'Otseq'},
    Otmeas:{label :'Otmeas'},
    Otum:{label :'Otum'},
    Otup:{label :'Otup'},
    Otqord:{label :'Otqord'},
    Otqbkord:{label :'Otqbkord'},
    Otqtoshp:{label :'Otqtoshp'},
    Otdftprc:{label :'Otdftprc'},
    Otprgroup:{label :'Otprgroup'},
    Otfrtwgt:{label :'Otfrtwgt'},
    Otjobcost:{label :'Otjobcost'},
    Otname:{label :'Otname'},
    Otglsale:{label :'Otglsale'},
    Otglcogs:{label :'Otglcogs'},
    Otglinv:{label :'Otglinv'},
    Otqship:{label :'Otqship'},
    Otprmeas:{label :'Otprmeas'},
    Otprum:{label :'Otprum'},
    Otbillunits:{label :'Otbillunits'},
    Otinvunits:{label :'Otinvunits'},
    Otcostflg:{label :'Otcostflg'},
    Otinvalloc:{label :'Otinvalloc'},
    Otshipdate:{label :'Otshipdate'},
    Sncode:{label :'Sncode'},
    OteqId:{label :'OteqId'},
    Oteqrate:{label :'Oteqrate'},
    Otleasing:{label :'Otleasing'},
    OtleasFinish:{label :'OtleasFinish'},
    Otflsqn:{label :'Otflsqn'},
    Otvplmn:{label :'Otvplmn'},
    Otflname:{label :'Otflname'},
    Otfct:{label :'Otfct'},
    Otlct:{label :'Otlct'},
    OtsimFrom:{label :'OtsimFrom'},
    OtsimTo:{label :'OtsimTo'},
    OttransactionDate:{label :'OttransactionDate'},
    ServcatCode:{label :'ServcatCode'},
    ServCode:{label :'ServCode'},
    ServType:{label :'ServType'},
    TaxInclusiveInd:{label :'TaxInclusiveInd'},
    OtglDisc:{label :'OtglDisc'},
    OtjcidDisc:{label :'OtjcidDisc'},
    OtglMincom:{label :'OtglMincom'},
    OtjcidMincom:{label :'OtjcidMincom'},
    GlCurrency:{label :'GlCurrency'},
    DocumentCurrency:{label :'DocumentCurrency'},
    OtamtDiscGl:{label :'OtamtDiscGl'},
    OtamtDiscGrossGl:{label :'OtamtDiscGrossGl'},
    OtamtMincomGl:{label :'OtamtMincomGl'},
    OtamtMincomGrossGl:{label :'OtamtMincomGrossGl'},
    OtamtRevenueGl:{label :'OtamtRevenueGl'},
    OtamtRevenueGrossGl:{label :'OtamtRevenueGrossGl'},
    OtcuramtDiscGl:{label :'OtcuramtDiscGl'},
    OtcuramtDiscGrossGl:{label :'OtcuramtDiscGrossGl'},
    OtcuramtGl:{label :'OtcuramtGl'},
    OtcuramtGrossGl:{label :'OtcuramtGrossGl'},
    OtcuramtMincomGl:{label :'OtcuramtMincomGl'},
    OtcuramtMincomGrossGl:{label :'OtcuramtMincomGrossGl'},
    OtcuramtRevenueGl:{label :'OtcuramtRevenueGl'},
    OtcuramtRevenueGrossGl:{label :'OtcuramtRevenueGrossGl'},
    OtmerchGl:{label :'OtmerchGl'},
    OtmerchGrossGl:{label :'OtmerchGrossGl'},
    OtamtDiscDoc:{label :'OtamtDiscDoc'},
    OtamtDiscGrossDoc:{label :'OtamtDiscGrossDoc'},
    OtamtMincomDoc:{label :'OtamtMincomDoc'},
    OtamtMincomGrossDoc:{label :'OtamtMincomGrossDoc'},
    OtamtRevenueDoc:{label :'OtamtRevenueDoc'},
    OtamtRevenueGrossDoc:{label :'OtamtRevenueGrossDoc'},
    OtcuramtDiscDoc:{label :'OtcuramtDiscDoc'},
    OtcuramtDiscGrossDoc:{label :'OtcuramtDiscGrossDoc'},
    OtcuramtDoc:{label :'OtcuramtDoc'},
    OtcuramtGrossDoc:{label :'OtcuramtGrossDoc'},
    OtcuramtMincomDoc:{label :'OtcuramtMincomDoc'},
    OtcuramtMincomGrossDoc:{label :'OtcuramtMincomGrossDoc'},
    OtcuramtRevenueDoc:{label :'OtcuramtRevenueDoc'},
    OtcuramtRevenueGrossDoc:{label :'OtcuramtRevenueGrossDoc'},
    OtgpriceDisDoc:{label :'OtgpriceDisDoc'},
    OtgpriceDoc:{label :'OtgpriceDoc'},
    OtmerchDoc:{label :'OtmerchDoc'},
    OtmerchGrossDoc:{label :'OtmerchGrossDoc'},
    OttaxExemptedDoc:{label :'OttaxExemptedDoc'},
    RecVersion:{label :'RecVersion'},
    OtamtDiscSecdoc:{label :'OtamtDiscSecdoc'},
    OtamtDiscGrossSecdoc:{label :'OtamtDiscGrossSecdoc'},
    OtamtMincomSecdoc:{label :'OtamtMincomSecdoc'},
    OtamtMincomGrossSecdoc:{label :'OtamtMincomGrossSecdoc'},
    OtamtRevenueSecdoc:{label :'OtamtRevenueSecdoc'},
    OtamtRevenueGrossSecdoc:{label :'OtamtRevenueGrossSecdoc'},
    OtgpriceSecdoc:{label :'OtgpriceSecdoc'},
    OtgpriceDisSecdoc:{label :'OtgpriceDisSecdoc'},
    OtmerchSecdoc:{label :'OtmerchSecdoc'},
    OtmerchGrossSecdoc:{label :'OtmerchGrossSecdoc'},
    Otflrapflg:{label :'Otflrapflg'},
    TapRefNo:{label :'TapRefNo'},
    TaxCalculationType:{label :'TaxCalculationType'},
    ProfileId:{label :'ProfileId'},
    PaymentOption:{label :'PaymentOption'},
    BpCoId:{label :'BpCoId'},
    Otcostcent:{label :'Otcostcent'},
    Otordnum:{label :'Otordnum'},
    IncomingDocTaxItemSeqno:{label :'IncomingDocTaxItemSeqno'},
    Tmcode:{label :'Tmcode'},
    RateplanVscode:{label :'RateplanVscode'},
    Spcode:{label :'Spcode'},
    InvoiceItemClassId:{label :'InvoiceItemClassId'},
    Ordertrailer:{Heading:'Ordertrailer',
        Otxact:{header:'Otxact'},
        Otseq:{header:'Otseq'},
        Otmeas:{header:'Otmeas'},
        Otum:{header:'Otum'},
        Otup:{header:'Otup'},
        Otqord:{header:'Otqord'},
        Otqbkord:{header:'Otqbkord'},
        Otqtoshp:{header:'Otqtoshp'},
        Otdftprc:{header:'Otdftprc'},
        Otprgroup:{header:'Otprgroup'},
        Otfrtwgt:{header:'Otfrtwgt'},
        Otjobcost:{header:'Otjobcost'},
        Otname:{header:'Otname'},
        Otglsale:{header:'Otglsale'},
        Otglcogs:{header:'Otglcogs'},
        Otglinv:{header:'Otglinv'},
        Otqship:{header:'Otqship'},
        Otprmeas:{header:'Otprmeas'},
        Otprum:{header:'Otprum'},
        Otbillunits:{header:'Otbillunits'},
        Otinvunits:{header:'Otinvunits'},
        Otcostflg:{header:'Otcostflg'},
        Otinvalloc:{header:'Otinvalloc'},
        Otshipdate:{header:'Otshipdate'},
        Sncode:{header:'Sncode'},
        OteqId:{header:'OteqId'},
        Oteqrate:{header:'Oteqrate'},
        Otleasing:{header:'Otleasing'},
        OtleasFinish:{header:'OtleasFinish'},
        Otflsqn:{header:'Otflsqn'},
        Otvplmn:{header:'Otvplmn'},
        Otflname:{header:'Otflname'},
        Otfct:{header:'Otfct'},
        Otlct:{header:'Otlct'},
        OtsimFrom:{header:'OtsimFrom'},
        OtsimTo:{header:'OtsimTo'},
        OttransactionDate:{header:'OttransactionDate'},
        ServcatCode:{header:'ServcatCode'},
        ServCode:{header:'ServCode'},
        ServType:{header:'ServType'},
        TaxInclusiveInd:{header:'TaxInclusiveInd'},
        OtglDisc:{header:'OtglDisc'},
        OtjcidDisc:{header:'OtjcidDisc'},
        OtglMincom:{header:'OtglMincom'},
        OtjcidMincom:{header:'OtjcidMincom'},
        GlCurrency:{header:'GlCurrency'},
        DocumentCurrency:{header:'DocumentCurrency'},
        OtamtDiscGl:{header:'OtamtDiscGl'},
        OtamtDiscGrossGl:{header:'OtamtDiscGrossGl'},
        OtamtMincomGl:{header:'OtamtMincomGl'},
        OtamtMincomGrossGl:{header:'OtamtMincomGrossGl'},
        OtamtRevenueGl:{header:'OtamtRevenueGl'},
        OtamtRevenueGrossGl:{header:'OtamtRevenueGrossGl'},
        OtcuramtDiscGl:{header:'OtcuramtDiscGl'},
        OtcuramtDiscGrossGl:{header:'OtcuramtDiscGrossGl'},
        OtcuramtGl:{header:'OtcuramtGl'},
        OtcuramtGrossGl:{header:'OtcuramtGrossGl'},
        OtcuramtMincomGl:{header:'OtcuramtMincomGl'},
        OtcuramtMincomGrossGl:{header:'OtcuramtMincomGrossGl'},
        OtcuramtRevenueGl:{header:'OtcuramtRevenueGl'},
        OtcuramtRevenueGrossGl:{header:'OtcuramtRevenueGrossGl'},
        OtmerchGl:{header:'OtmerchGl'},
        OtmerchGrossGl:{header:'OtmerchGrossGl'},
        OtamtDiscDoc:{header:'OtamtDiscDoc'},
        OtamtDiscGrossDoc:{header:'OtamtDiscGrossDoc'},
        OtamtMincomDoc:{header:'OtamtMincomDoc'},
        OtamtMincomGrossDoc:{header:'OtamtMincomGrossDoc'},
        OtamtRevenueDoc:{header:'OtamtRevenueDoc'},
        OtamtRevenueGrossDoc:{header:'OtamtRevenueGrossDoc'},
        OtcuramtDiscDoc:{header:'OtcuramtDiscDoc'},
        OtcuramtDiscGrossDoc:{header:'OtcuramtDiscGrossDoc'},
        OtcuramtDoc:{header:'OtcuramtDoc'},
        OtcuramtGrossDoc:{header:'OtcuramtGrossDoc'},
        OtcuramtMincomDoc:{header:'OtcuramtMincomDoc'},
        OtcuramtMincomGrossDoc:{header:'OtcuramtMincomGrossDoc'},
        OtcuramtRevenueDoc:{header:'OtcuramtRevenueDoc'},
        OtcuramtRevenueGrossDoc:{header:'OtcuramtRevenueGrossDoc'},
        OtgpriceDisDoc:{header:'OtgpriceDisDoc'},
        OtgpriceDoc:{header:'OtgpriceDoc'},
        OtmerchDoc:{header:'OtmerchDoc'},
        OtmerchGrossDoc:{header:'OtmerchGrossDoc'},
        OttaxExemptedDoc:{header:'OttaxExemptedDoc'},
        RecVersion:{header:'RecVersion'},
        OtamtDiscSecdoc:{header:'OtamtDiscSecdoc'},
        OtamtDiscGrossSecdoc:{header:'OtamtDiscGrossSecdoc'},
        OtamtMincomSecdoc:{header:'OtamtMincomSecdoc'},
        OtamtMincomGrossSecdoc:{header:'OtamtMincomGrossSecdoc'},
        OtamtRevenueSecdoc:{header:'OtamtRevenueSecdoc'},
        OtamtRevenueGrossSecdoc:{header:'OtamtRevenueGrossSecdoc'},
        OtgpriceSecdoc:{header:'OtgpriceSecdoc'},
        OtgpriceDisSecdoc:{header:'OtgpriceDisSecdoc'},
        OtmerchSecdoc:{header:'OtmerchSecdoc'},
        OtmerchGrossSecdoc:{header:'OtmerchGrossSecdoc'},
        Otflrapflg:{header:'Otflrapflg'},
        TapRefNo:{header:'TapRefNo'},
        TaxCalculationType:{header:'TaxCalculationType'},
        ProfileId:{header:'ProfileId'},
        PaymentOption:{header:'PaymentOption'},
        BpCoId:{header:'BpCoId'},
        Otcostcent:{header:'Otcostcent'},
        Otordnum:{header:'Otordnum'},
        IncomingDocTaxItemSeqno:{header:'IncomingDocTaxItemSeqno'},
        Tmcode:{header:'Tmcode'},
        RateplanVscode:{header:'RateplanVscode'},
        Spcode:{header:'Spcode'},
        InvoiceItemClassId:{header:'InvoiceItemClassId'},
        },
    }

router.get('/', sessionChecker, function(req, res, next) {
    var jsonObj = req.query;
    if(jsonObj.rowid===undefined) jsonObj.rowid = 0;
    req.session.previouspath = 'searchOrdertrailer?'+req._parsedUrl.query;
    dao.searchOrdertrailer(jsonObj,function(err,rows) {
        parameter = {
            session: req.session,
            cookies: req.cookies,
            resource: appresource,
            dateFormat: dateFormat,
            records: rows,
        }
        res.render('OrdertrailerSearchPage',parameter);
        console.log(parameter);        
    })
});

module.exports = router;
